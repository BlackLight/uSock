\hypertarget{classusock_1_1RawSocket}{
\section{usock::RawSocket Class Reference}
\label{classusock_1_1RawSocket}\index{usock::RawSocket@{usock::RawSocket}}
}
Class for managing raw sockets.  


{\tt \#include $<$usock.h$>$}

Inheritance diagram for usock::RawSocket::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classusock_1_1RawSocket}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\hyperlink{classusock_1_1RawSocket_d476598f4a6db6d3cf28673172eb1b8b}{RawSocket} (std::string i=\char`\"{}lo\char`\"{})
\begin{CompactList}\small\item\em \hyperlink{classusock_1_1RawSocket}{RawSocket} constructor. \item\end{CompactList}\item 
std::string \hyperlink{classusock_1_1RawSocket_3b0c8f2f539982c8f37a66ebc29746a0}{getIPv4addr} ()  throw ()
\begin{CompactList}\small\item\em Get the IPv4 address associated to the network interface. \item\end{CompactList}\item 
std::string \hyperlink{classusock_1_1RawSocket_1276f5fcc7bc3b41d9d11055887ab7a9}{getHWaddr} ()  throw ()
\begin{CompactList}\small\item\em Get the HW address associated to the network interface. \item\end{CompactList}\item 
u\_\-int16\_\-t \hyperlink{classusock_1_1RawSocket_11c89cceced7302fe25163fbc74a6b83}{csum} (u\_\-int16\_\-t $\ast$buf, int nwords)
\begin{CompactList}\small\item\em Compute the checksum of a buffer. \item\end{CompactList}\item 
void \hyperlink{classusock_1_1RawSocket_999a433a049b33006ab8c26a7d0875b9}{buildIPv4} (std::string dst, std::string src=\char`\"{}\char`\"{}, u\_\-int8\_\-t proto=IPPROTO\_\-TCP, u\_\-int16\_\-t len=0, u\_\-int8\_\-t ttl=32, u\_\-int8\_\-t tos=0, u\_\-int16\_\-t id=0, u\_\-int16\_\-t frag=0, u\_\-int16\_\-t sum=0)
\begin{CompactList}\small\item\em Build an IPv4 header for the raw socket. \item\end{CompactList}\item 
void \hyperlink{classusock_1_1RawSocket_687afa2e3259ce2bc2cea7cc49db7f14}{buildTCP} (u\_\-int16\_\-t sport, u\_\-int16\_\-t dport, u\_\-int8\_\-t flags, u\_\-int32\_\-t seq=0, u\_\-int32\_\-t ack=0, u\_\-int16\_\-t window=0x1000, u\_\-int16\_\-t urgent=0, u\_\-int16\_\-t sum=0)
\begin{CompactList}\small\item\em Build a TCP header for the raw socket. \item\end{CompactList}\item 
void \hyperlink{classusock_1_1RawSocket_20dc8f4e7c0f5d499517b6410c5dca52}{buildUDP} (u\_\-int16\_\-t sport, u\_\-int16\_\-t dport, u\_\-int16\_\-t len=0, u\_\-int16\_\-t sum=0)
\begin{CompactList}\small\item\em Build an UDP header for the raw socket. \item\end{CompactList}\item 
void \hyperlink{classusock_1_1RawSocket_bf253d275f07db49c00f4b0d8fcf0947}{buildICMPv4} (u\_\-int8\_\-t \hyperlink{classusock_1_1BaseSocket_8117d25c7b482eb594d68137868ce5f9}{type}, u\_\-int16\_\-t id=0x100, u\_\-int16\_\-t seq=0x100, u\_\-int8\_\-t code=0, u\_\-int16\_\-t sum=0)
\begin{CompactList}\small\item\em Build an ICMPv4 header for the raw socket. \item\end{CompactList}\item 
void \hyperlink{classusock_1_1RawSocket_de9254ad3499aebabedad9b861c21bdb}{setPayload} (void $\ast$payload, int length)
\begin{CompactList}\small\item\em Set a binary payload for the raw socket. \item\end{CompactList}\item 
void \hyperlink{classusock_1_1RawSocket_ab429ec3a150c6e15175b3223c90ade6}{setPayload} (std::string payload)
\begin{CompactList}\small\item\em Set a payload for the raw socket as a string. \item\end{CompactList}\item 
void \hyperlink{classusock_1_1RawSocket_e62377b0933a176570f226e1acbe3e16}{write} ()  throw ()
\begin{CompactList}\small\item\em Write the raw packet onto the network interface. \item\end{CompactList}\item 
void $\ast$ \hyperlink{classusock_1_1RawSocket_bc4cd4449b47d28397fc270447405609}{read} (u\_\-int32\_\-t len, const std::string \&host=\char`\"{}\char`\"{})  throw ()
\begin{CompactList}\small\item\em Read binary data from the raw socket. \item\end{CompactList}\end{CompactItemize}


\subsection{Detailed Description}
Class for managing raw sockets. 

\begin{Desc}
\item[Author:]BlackLight \end{Desc}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classusock_1_1RawSocket_d476598f4a6db6d3cf28673172eb1b8b}{
\index{usock::RawSocket@{usock::RawSocket}!RawSocket@{RawSocket}}
\index{RawSocket@{RawSocket}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{RawSocket}]{\setlength{\rightskip}{0pt plus 5cm}usock::RawSocket::RawSocket (std::string {\em i} = {\tt \char`\"{}lo\char`\"{}})}}
\label{classusock_1_1RawSocket_d476598f4a6db6d3cf28673172eb1b8b}


\hyperlink{classusock_1_1RawSocket}{RawSocket} constructor. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em i}]Interface on which we're going to bind our raw socket \end{description}
\end{Desc}


\subsection{Member Function Documentation}
\hypertarget{classusock_1_1RawSocket_bf253d275f07db49c00f4b0d8fcf0947}{
\index{usock::RawSocket@{usock::RawSocket}!buildICMPv4@{buildICMPv4}}
\index{buildICMPv4@{buildICMPv4}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{buildICMPv4}]{\setlength{\rightskip}{0pt plus 5cm}void usock::RawSocket::buildICMPv4 (u\_\-int8\_\-t {\em type}, \/  u\_\-int16\_\-t {\em id} = {\tt 0x100}, \/  u\_\-int16\_\-t {\em seq} = {\tt 0x100}, \/  u\_\-int8\_\-t {\em code} = {\tt 0}, \/  u\_\-int16\_\-t {\em sum} = {\tt 0})}}
\label{classusock_1_1RawSocket_bf253d275f07db49c00f4b0d8fcf0947}


Build an ICMPv4 header for the raw socket. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em type}]ICMP type \item[{\em id}]Packet ID (default: 0x100) \item[{\em seq}]Sequence number (default: 0x100) \item[{\em code}]ICMP code (default: 0) \item[{\em sum}]ICMP checksum (default: auto-computed) \end{description}
\end{Desc}
\hypertarget{classusock_1_1RawSocket_999a433a049b33006ab8c26a7d0875b9}{
\index{usock::RawSocket@{usock::RawSocket}!buildIPv4@{buildIPv4}}
\index{buildIPv4@{buildIPv4}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{buildIPv4}]{\setlength{\rightskip}{0pt plus 5cm}void usock::RawSocket::buildIPv4 (std::string {\em dst}, \/  std::string {\em src} = {\tt \char`\"{}\char`\"{}}, \/  u\_\-int8\_\-t {\em proto} = {\tt IPPROTO\_\-TCP}, \/  u\_\-int16\_\-t {\em len} = {\tt 0}, \/  u\_\-int8\_\-t {\em ttl} = {\tt 32}, \/  u\_\-int8\_\-t {\em tos} = {\tt 0}, \/  u\_\-int16\_\-t {\em id} = {\tt 0}, \/  u\_\-int16\_\-t {\em frag} = {\tt 0}, \/  u\_\-int16\_\-t {\em sum} = {\tt 0})}}
\label{classusock_1_1RawSocket_999a433a049b33006ab8c26a7d0875b9}


Build an IPv4 header for the raw socket. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dst}]Destination hostname/address \item[{\em src}]Source hostname/address (default: IPv4 address associated to the network interface) \item[{\em proto}]Transport protocol (default: TCP) \item[{\em len}]Total length of the IPv4 datagram (default: header length + payload length) \item[{\em ttl}]Time To Live (default: 32) \item[{\em tos}]Type Of Service (default: 0) \item[{\em id}]Datagram ID (default: 0) \item[{\em frag}]Fragmentation flag (default: 0) \item[{\em sum}]IPv4 checksum (default: auto-computed) \end{description}
\end{Desc}
\hypertarget{classusock_1_1RawSocket_687afa2e3259ce2bc2cea7cc49db7f14}{
\index{usock::RawSocket@{usock::RawSocket}!buildTCP@{buildTCP}}
\index{buildTCP@{buildTCP}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{buildTCP}]{\setlength{\rightskip}{0pt plus 5cm}void usock::RawSocket::buildTCP (u\_\-int16\_\-t {\em sport}, \/  u\_\-int16\_\-t {\em dport}, \/  u\_\-int8\_\-t {\em flags}, \/  u\_\-int32\_\-t {\em seq} = {\tt 0}, \/  u\_\-int32\_\-t {\em ack} = {\tt 0}, \/  u\_\-int16\_\-t {\em window} = {\tt 0x1000}, \/  u\_\-int16\_\-t {\em urgent} = {\tt 0}, \/  u\_\-int16\_\-t {\em sum} = {\tt 0})}}
\label{classusock_1_1RawSocket_687afa2e3259ce2bc2cea7cc49db7f14}


Build a TCP header for the raw socket. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em sport}]Source port \item[{\em dport}]Destination port \item[{\em flags}]TCP flags \item[{\em seq}]Sequence number (default: randomly generated) \item[{\em ack}]ACK number (default: 0) \item[{\em window}]Window size (default: 16) \item[{\em urgent}]Urgent pointer (default: 0) \item[{\em sum}]TCP checksum (default: auto-computed) \end{description}
\end{Desc}
\hypertarget{classusock_1_1RawSocket_20dc8f4e7c0f5d499517b6410c5dca52}{
\index{usock::RawSocket@{usock::RawSocket}!buildUDP@{buildUDP}}
\index{buildUDP@{buildUDP}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{buildUDP}]{\setlength{\rightskip}{0pt plus 5cm}void usock::RawSocket::buildUDP (u\_\-int16\_\-t {\em sport}, \/  u\_\-int16\_\-t {\em dport}, \/  u\_\-int16\_\-t {\em len} = {\tt 0}, \/  u\_\-int16\_\-t {\em sum} = {\tt 0})}}
\label{classusock_1_1RawSocket_20dc8f4e7c0f5d499517b6410c5dca52}


Build an UDP header for the raw socket. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em sport}]Source port \item[{\em dport}]Destination port \item[{\em len}]UDP header + payload length (default: auto-computed) \item[{\em sum}]UDP checksum (default: auto-computed) \end{description}
\end{Desc}
\hypertarget{classusock_1_1RawSocket_11c89cceced7302fe25163fbc74a6b83}{
\index{usock::RawSocket@{usock::RawSocket}!csum@{csum}}
\index{csum@{csum}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{csum}]{\setlength{\rightskip}{0pt plus 5cm}u\_\-int16\_\-t usock::RawSocket::csum (u\_\-int16\_\-t $\ast$ {\em buf}, \/  int {\em nwords})}}
\label{classusock_1_1RawSocket_11c89cceced7302fe25163fbc74a6b83}


Compute the checksum of a buffer. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em buf}]Buffer \item[{\em nwords}]Number of 16-bits words inside buf \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]Checksum \end{Desc}
\hypertarget{classusock_1_1RawSocket_1276f5fcc7bc3b41d9d11055887ab7a9}{
\index{usock::RawSocket@{usock::RawSocket}!getHWaddr@{getHWaddr}}
\index{getHWaddr@{getHWaddr}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{getHWaddr}]{\setlength{\rightskip}{0pt plus 5cm}std::string usock::RawSocket::getHWaddr ()  throw ()}}
\label{classusock_1_1RawSocket_1276f5fcc7bc3b41d9d11055887ab7a9}


Get the HW address associated to the network interface. 

\begin{Desc}
\item[Returns:]The HW/MAC address, if the interface is valid, up and running \end{Desc}
\hypertarget{classusock_1_1RawSocket_3b0c8f2f539982c8f37a66ebc29746a0}{
\index{usock::RawSocket@{usock::RawSocket}!getIPv4addr@{getIPv4addr}}
\index{getIPv4addr@{getIPv4addr}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{getIPv4addr}]{\setlength{\rightskip}{0pt plus 5cm}std::string usock::RawSocket::getIPv4addr ()  throw ()}}
\label{classusock_1_1RawSocket_3b0c8f2f539982c8f37a66ebc29746a0}


Get the IPv4 address associated to the network interface. 

\begin{Desc}
\item[Returns:]IPv4 address, if the interface is valid, up and running \end{Desc}
\hypertarget{classusock_1_1RawSocket_bc4cd4449b47d28397fc270447405609}{
\index{usock::RawSocket@{usock::RawSocket}!read@{read}}
\index{read@{read}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{read}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ usock::RawSocket::read (u\_\-int32\_\-t {\em len}, \/  const std::string \& {\em host} = {\tt \char`\"{}\char`\"{}})  throw ()}}
\label{classusock_1_1RawSocket_bc4cd4449b47d28397fc270447405609}


Read binary data from the raw socket. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em len}]Number of bytes to be read \item[{\em host}]Host name/address we're going to receive our packet from (default: any) \end{description}
\end{Desc}
\hypertarget{classusock_1_1RawSocket_ab429ec3a150c6e15175b3223c90ade6}{
\index{usock::RawSocket@{usock::RawSocket}!setPayload@{setPayload}}
\index{setPayload@{setPayload}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{setPayload}]{\setlength{\rightskip}{0pt plus 5cm}void usock::RawSocket::setPayload (std::string {\em payload})}}
\label{classusock_1_1RawSocket_ab429ec3a150c6e15175b3223c90ade6}


Set a payload for the raw socket as a string. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em payload}]Our payload \end{description}
\end{Desc}
\hypertarget{classusock_1_1RawSocket_de9254ad3499aebabedad9b861c21bdb}{
\index{usock::RawSocket@{usock::RawSocket}!setPayload@{setPayload}}
\index{setPayload@{setPayload}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{setPayload}]{\setlength{\rightskip}{0pt plus 5cm}void usock::RawSocket::setPayload (void $\ast$ {\em payload}, \/  int {\em length})}}
\label{classusock_1_1RawSocket_de9254ad3499aebabedad9b861c21bdb}


Set a binary payload for the raw socket. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em payload}]Binary payload \item[{\em length}]payload's length \end{description}
\end{Desc}
\hypertarget{classusock_1_1RawSocket_e62377b0933a176570f226e1acbe3e16}{
\index{usock::RawSocket@{usock::RawSocket}!write@{write}}
\index{write@{write}!usock::RawSocket@{usock::RawSocket}}
\subsubsection[{write}]{\setlength{\rightskip}{0pt plus 5cm}void usock::RawSocket::write ()  throw ()}}
\label{classusock_1_1RawSocket_e62377b0933a176570f226e1acbe3e16}


Write the raw packet onto the network interface. 



The documentation for this class was generated from the following file:\begin{CompactItemize}
\item 
\hyperlink{usock_8h}{usock.h}\end{CompactItemize}
